{% extends "public.html" %} {% from "macros.jinja" import window_vars with context
%}{% block page %}
<div class="row q-ml-xl">

  <div class="col-md-6">
    <q-card-section>
    <q-card class="q-pa-lg">
    <div id="map" style="width: 100%; height: 300px;"></div>
     <p>Top-left words: {{ bottomRight }} <br/>
      Bottom-right words: {{ topLeft }}</p> 
    </q-card>
  </q-card-section>
  </div>
  <div class="col-md-2">
      <q-card-section>
      <q-card class="q-pa-lg q-pt-xl lnbits__dialog-card">
      <q-form @submit="makePayment" class="q-gutter-md">
        <q-input
          filled
          dense
          type="number"
          v-model="payDialog.data.sats"
          label="amount of sats *"
        ></q-input>
        <div class="row q-mt-lg">
          <q-btn
            unelevated
            color="deep-purple"
            :disable="
            payDialog.data.sats == null"
            type="submit"
            >Fund map</q-btn
          >
        </div>
      </q-form>
      
    </q-card>
  </q-card-section>
  </div>
  <q-dialog v-model="payDialog.show" position="top" @hide="closepayDialog">
    <q-card class="q-pa-lg q-pt-xl" style="width: 500px">

    </q-card>
  </q-dialog>
</div>
{% endblock %} {% block scripts %}
<script src="/scrambles/static/js/test.js"></script>
<link rel="stylesheet" href="/scrambles/static/css/leaflet.css" />
<script src="/scrambles/static/js/leaflet.js"></script>
<script src="/scrambles/static/js/main.js"></script>
<script>
  Vue.component(VueQrcode.name, VueQrcode)
  new Vue({
    el: '#vue',
    mixins: [windowMixin],
    data: function () {
      return {
        here: location.protocol + '//' + location.host,
        payDialog: {
        show: false,

        data: {
        game_id: "",
        top_left: "slush fortune raw problem",
        bottom_right: "slush edit ticket allow",
        sats: 100,
        }
        },
      }
    },
    methods: {
      getInvoice: function () {
      var self = this
      var data = self.payDialog.data
      LNbits.api
        .request(
          'POST',
          '/scrambles/api/v1/funding/',
           "whatevs", data
        )
        .then(function (response) {
          self.scramblesgames = response.data.map(function (obj) {
            return mapscramblesgame(obj)
          })
        })
        .catch(function (error) {
          clearInterval(self.checker)
          LNbits.utils.notifyApiError(error)
        })
    },
      makePayment: function () {
      var self = this
      self.payDialog.show = true
      self.getInvoice()
    },
    closepayDialog: function () {
      var self = this
      self.payDialog.show = false
      self.payDialog.data = {}
    },
    wooo: function () {
      this.payDialog.data.game_id = window.location.pathname.split("/").pop()
      console.log(fromWords(["slush", "edit", "ticket", "allow"]));

      var map = L.map('map', {
    center: [51.505, -0.09],
    zoom: 13
});
var bounds = [[54.559322, -5.767822], [56.1210604, -3.021240]];

// create an orange rectangle
//L.rectangle(bounds, {color: "#ff7800", weight: 1}).addTo(map);

L.tileLayer(
 'https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoiYmVuYXJjIiwiYSI6ImNra2QybXdidTA3NzEyd255MXp6cjczbDEifQ.ZyN1juw69Q2spV4fpLxGBQ',
  {
    zoomSnap: 2,
    maxZoom: 18,
    id: 'mapbox/streets-v11'
  }
).addTo(map)

// zoom the map to the rectangle bounds
map.fitBounds(bounds);


	var popup = L.popup();

	function onMapClick(e) {
		popup
			.setLatLng(e.latlng)
			.setContent("You clicked the map at " + e.latlng.toString())
			.openOn(map);
	}

	map.on('click', onMapClick);

    }
  },
  created: function () {
    this.wooo()
  }
})
</script>

{% endblock %}
